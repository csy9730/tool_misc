# stm32f103最小系统的组成及各部分功能

[![无际单片机](https://picx.zhimg.com/v2-e54356a9ff18337f93d9000a51b2bcc4_l.jpg?source=172ae18b)](https://www.zhihu.com/people/tou-wen-zi-e-96)

[无际单片机](https://www.zhihu.com/people/tou-wen-zi-e-96)![img](https://pic1.zhimg.com/v2-4812630bc27d642f7cafcd6cdeca3d7a.jpg?source=88ceefae)

53 人赞同了该文章

今天来跟大家普及一下stm32f103单片机的最小系统组成和各部分功能。

**一、** **什么叫最小系统**

最小系统就像我们人，我们活着每天都要吃饭，喝水。

饭和水就是我们的”燃料”，离开它们我们就挂逼了。

其实在芯片的世界也一样，单片机想要正常运行，它也需要”燃料”，这些燃料的组成就是最小系统。

**二、** **“燃料”都由什么组成？**

**1.** **电源**

![img](https://pic2.zhimg.com/80/v2-11856f0e8c9ddb5baac804758df9dab9_720w.webp)

拿STM32F103C8T6这个型号来说，总共有5个接电源正极和4个接地引脚，分别给内部不用的模块供电。

VDD：就是单片机的供电电压。

VDDA：VDD后面有个A，A=Analog，表示模拟的意思，就是芯片内部模拟器件的工作电压。

VSSA：表示模拟器件的公共端地。

VBAT：给后备区域供电，维持RTC/BKP寄存器这些数据掉电保存，一般是接纽扣电池，如果不需要可以直接接电源。

![img](https://pic4.zhimg.com/80/v2-d485e3103d8744b076171e01a2f76623_720w.webp)

根据数据手册的说明，这几个引脚的供电电压最大不能超过3.6V。

说到数据手册，作为一个英语渣，这里多说一句，不要怕全是英文，不用全看懂，抓关键的地方看，其实来来去去就那几个英文。

**2.** **复位电路**

![img](https://pic1.zhimg.com/80/v2-b767fe71c5fb2848737db0b9266298cc_720w.webp)

复位电路的作用就是，板子上电的瞬间给单片机复位引脚(NRST)一个短暂的低电平，让单片机程序复位，把除了备份区域寄存器以外所有寄存器状态恢复原始状态。

**简单来说就是让程序重头开始跑。**

复位电路的原理是**利用RC电路的充放电原理，**在上电瞬间为NRST引脚产生一个短暂的低电平。

刚上电的时候电流会通过R19和C20到地，为C20充电，此时NRST的引脚为低电平。

当C20充满电以后，C20就处于”断路”的状态，此时NRST由低变高电平。

**3. 外部晶振电路**

![img](https://pic1.zhimg.com/80/v2-99d4d22b6f586a753d2c6273fdc24254_720w.webp)

![img](https://pic2.zhimg.com/80/v2-9b5ef6891be991057a1449fc37d011ed_720w.webp)

系统时钟一般是加外部晶振电路，相当于给单片机一个心跳。

就跟人的心跳一样，没心跳肯定就GG了。

同样，单片机没心跳也跑不起程序。

这个心跳也是一个时机基准，为单片机系统时钟、定时器之类的提供时间的基准。

我们最终计算定时器的时间，都跟这个晶振息息相关。

**4.** **烧录口**

![img](https://pic2.zhimg.com/80/v2-6fbe87bfaa93fe6b12a038d099fbbf75_720w.webp)

烧录口的作用就是给单片机烧录程序，注入灵魂。

STM32的烧录方式有几种，实际产品开发一般用SWD接口烧录，占用尺寸空间少，一般只需要5根线，也有些用4根线的，就是vdd不接，不接vdd烧录要单独给板子供电。

**5.** **Boot0和Boot1**

Boot0和Boot1是用来选择STM32单片机的启动方式的。

![img](https://pic2.zhimg.com/80/v2-b3ef58c3100983c7b90c83818e22e829_720w.webp)

如果上图你看不懂什么意思，不要慌，正常的。

简单来说，大家要想正常跑程序就要把Boot0和Boot1都接到地，就是正常工作模式。

如果我们要使用串口烧录，也就是ISP，就需要把BOOT0接到电源，BOOT1接到地，烧录完以后再全部接到地，相对麻烦很多。

这也就是为什么我只用SWD烧录的原因，直接全部接地就行了。

![img](https://pic4.zhimg.com/80/v2-45663bcec8d2abf0e49bb9d202626f8f_720w.webp)

通过上面这些电路的组合，单片机就能正常跑程序了。

**如何验证你程序有没有正常在跑？**

我一般在开发产品的时候，首先会把LED的驱动调出来获取安全感，让它每秒闪一次。

防止程序死机了我还傻乎乎继续写程序，写到后面程序大了，找起问题来更浪费时间。