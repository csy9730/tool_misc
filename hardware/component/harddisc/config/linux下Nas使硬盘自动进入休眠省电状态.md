# linux下Nas使硬盘自动进入休眠省电状态

我在爱的国 2019-06-18 11:15:26  12685  收藏 14
分类专栏： 软件配置 操作系统
版权
在日常使用中机械盘的使用频率是非常低的,尤其是安装了很多块硬盘的Nas,本文介绍如何自动关闭机械盘节电。
我们使用的命令是hdparm。详细说明可在命令行中执行

man hdparm
-S参数可以设置磁盘进入待命状态 (Standby/Spindown)的超时时间。该值用以确定磁盘在处于无活动状态多长时间后关闭旋转电机。

-B为磁盘的电源管理参数。它的取值用于平衡磁盘的性能与电耗。当取值大于127(除255)时磁盘将不会断电。取值255意味着关闭电源管理功能。为了让磁盘能自动断电，我们将该值取127.


1.设置硬盘省电策略

无访问一定时间后自动停转待机(在ubuntu 19.04上亲试有生效)

hdparm -S 60 /dev/hd*
这里-S取值设定逻辑比较奇怪，本文列出部分常见取值供选：
30 = 2 min 30 sec
60 = 5 minutes
120 = 10 minutes
180 = 15 minutes
241 = 30 minutes
242 = 1 hour
243 = 1.5 hours
244 = 2 hours

2.使硬盘立马进入省电状态

hdparm -Y /dev/sd*
我的策略是编辑定时任务列表

sudo vi /etc/crontab

加入如下一行(10分钟一次使硬盘进入休眠状态)

*/10 * * * *    root    hdparm -Y /dev/sd*
3.检查硬盘当前省电状态

sudo hdparm -C /dev/sd*