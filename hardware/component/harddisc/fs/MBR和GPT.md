# MBR和GPT

## base

相关概念 包括 BIOS，磁盘，分区，文件系统。

### BIOS
#### UEFI & Legacy
Legacy Bios 和 UEFI，Legacy Bios 是传统的 Bios，后来被 EFI 取代，再后来更名为 UEFI。近几年的电脑一般都支持 UEFI 引导。

Legacy Bios 用于引导MBR 硬盘。
UEFI Bios 用于引导GPT硬盘。

### disc

#### SSD & HDD
固态硬盘 SSD，普通硬盘 HDD

#### MBR 
MBR与GPT都是硬盘用于启动系统的分区表格式，未初始化的全新硬盘在装系统之前，必须对系统的分区表格式进行选择，不同的分区表格式定义了数据信息是如何在硬盘分区中被构筑的，Windows系统使用的分区表格式分为MBR和GPT两种。

#### GPT
GPT 必须使用 UEFI 的主板引导。

总而言之，UEFI + GPT 是最好的方案，重装系统的时候最好将自己的主板和硬盘转换成 UEFI + GPT.


#### guid
guid和gpt区别？

其实两者并没有区别guid就是GPT，GUID分区表(简称GPT。使用GUID分区表的磁盘称为GPT磁盘)是源自EFI标准的一种较新的磁盘分区表结构的标准。与目前普遍使用的主引导记录(MBR)分区方案相比，GPT提供了更加灵活的磁盘分区机制。

##### 动态磁盘&基础磁盘
动态磁盘/基础磁盘的概念是适用于整个实体硬盘和对应的所有分区，不是单个分区。
动态磁盘的弊端是仅 Windows 系统支持读写这种磁盘。动态磁盘linux无法识别挂载，不兼容双系统.

动态磁主要的优势在于将不同的硬盘合在一块，当作一块硬盘用。

### 分区

机械盘空间的起点在盘的边缘，转速一定时线速度最高。所以分几个区之后，第一个区性能一定最高，最后一个区性能最低。

- 主分区和活动分区：
- 逻辑分区和扩展分区：

#### 主引导扇区
主引导扇区：每块硬盘，对，每块硬盘不是每个分区，都只有一个主引导扇区，即该硬盘0号柱面，0号磁头的第一个扇区，大小为512字节。主引导扇区包含的MBR、DPT、幻数, BOIS读取MBR的时候总是检查最后是不是有这两个幻数,如果没有就被认为是一个没有被分区的硬盘），这3个区域是操作系统无关的，在每块硬盘上都存在；MBR是一段可执行程序，由各个操作系统写入不同的代码。MBR的存储空间限制为446字节，MBR所做的唯一的事情就是装载第二引导装载程序。Windows产生的MBR装载运行PBR；GRUB产生的MBR装载运行grldr

MBR内容合计 512B
- 硬盘主引导记MBR占 446B
- DPT（分区表DP占64B）
- magic number（硬盘有效标志Magic Numbe占2byte。AA和55被称为幻数(Magic Number)


grldr
PBR

#### 物理划分
**主分区**：实际上在早期的硬盘分区中并没有主分区、扩展分区和逻辑分区的概念，每个分区的类型都是主分区。由于硬盘仅仅为分区表保留了64个字节的存储空间，而每个分区的参数占据16个字节，故主引导扇区中总计只能存储4个分区的数据。也就是说，一块物理硬盘只能划分为4个逻辑磁盘。在具体的应用中，4个逻辑磁盘往往不能满足实际需求。为了建立更多的逻辑磁盘供操作系统使用，引入了扩展分区和逻辑分区，并把原来的分区类型称为主分区。

**扩展分区**：上面说了，4个分区显然不能满足需求，但是物理硬件限制只能有4个分区怎么办呢？所以操作系统开始出马了，把其中一个主分区命名为扩展分区，记住只是命名哦，原则上扩展分区和主分区是一样的，只不过功能不同。下面说完逻辑分区，你就懂我在说什么了。

**逻辑分区**：4个分区肯定不够，我想要20个分区，怎么办呢？把其中一个主分区变成扩展分区，然后在这个扩展分区上进行切割，变成一个个D盘，E盘，F盘什么的，但是这些盘综合起来就是一个扩展分区，这些盘是相互链接的，并不像主分区那样，4个之间相互独立互不干扰。逻辑分区用链表进行链接，如果E盘中的分区信息丢掉，操作系统就找不到F盘了。
逻辑分区是扩展分区（主分区）的分区

**一个硬盘最多4个主分区，每个分区对应一个逻辑磁盘. 可以把主分区转换成扩展分区，扩展分区可以继续划分出逻辑分区，每个逻辑分区对应一个逻辑磁盘。**

#### 逻辑划分
**启动分区**：很简单，存放操作系统文件的的分区，比如你装了2个系统：win7+linux那么你就2个启动分区。装的是windows的话就看windows文件夹（system32文件）存放在那个区，哪个区就是你的启动分区，默认装C盘，你也可以装F盘等。装的是Linux的话就看 / 分区装在哪，哪就是启动分区。

**系统分区**：存放Ntldr程序或者Grub程序的分区，windows通常装在C盘，linux通常装载/boot分区

**活动分区**：活动分区是主分区，活动分区是系统分区，且一块硬盘上只能有一个活动分区。每次PC启动时，一块硬盘只能有一个活动分区，如果要启动windows就将windows的系统分区设为活动分区，计算机就会去那里装载引导程序（Ntldr或者Grub）并执行，如果要启动Linux就将Linux的系统分区设为活动分区。

启动分区不唯一，可以有多个。

#### 其他划分
页面文件？

故障转储？

#### 分区概念
物理上：

       主分区1   ---   主分区2   ---   主分区3   ---   主分区4

逻辑上：

       系统分区(启动文件，装机后引导修复文件存储位置)   ---   启动分区(系统文件，装机文件)

       活动分区(开机之后从指定磁盘的哪一个分区加载启动文件，应该选择该磁盘上的一个系统分区)

#### 引导-装机-启动
（1）进入分区助手中，设置某磁盘分区 a 为系统分区，则安装系统之后的该系统的启动文件会自动存放在该分区。若还原之后无法正常启动，可能是未成功创建启动文件，可以在还原之后使用修复引导工具修复。

（2）安装系统到某磁盘分区 b，该分区即为系启动分区，存放系统文件。

（3）在 BIOS 中设置启动磁盘，则该盘上的系统分区(如果该磁盘只有一个系统分区)为活动分区，电脑启动时将从该分区加载启动文件。

### FS

windows下，文件系统建议 NTFS ，
linux下，文件系统选择 ext4。


**Q**: 挂载在无线路由器上的移动硬盘应该用 EXT4 还是 NTFS?

**A**: 
在 linux 中，同样的磁盘，使用 NTFS 的效率远远比 EXT4 低
XFS 对大文件支持很好，小文件支持很差。要中庸就选 EXT4 。


VFAT 和FAT32有什么关系？
## tool

fsck（file system check）用来检查和维护不一致的文件系统。若系统掉电或磁盘发生问题，可利用fsck命令对文件系统进行检查

C:\Windows\System32\diskmgmt.msc
C:\Windows\System32\diskpart.exe

