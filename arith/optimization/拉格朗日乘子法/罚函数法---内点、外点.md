# ﻿九、罚函数法---内点、外点

[![牙非涯](https://picx.zhimg.com/v2-27797f8e8432a814f4a15121eca9b6a8_l.jpg?source=172ae18b)](https://www.zhihu.com/people/hao-hai-zi-82-51)

[牙非涯](https://www.zhihu.com/people/hao-hai-zi-82-51)

不会代码的码农

45 人赞同了该文章

> 罚函数方法的基本思想是借助罚函数**将约束问题转化为无约束优化问题**，进而通过求解一系列无约束最优化问题来获取原约束问题的解。迭代过程中， 罚函数法通过**对不可行点施加惩罚**，迫使迭代点向可行域靠近。一旦迭代点成为可行点，则这个可行点就是原问题的最优解

**惩罚函数可以分为外点法和内点法：**

- 外点法更通用，可解决约束为等式和不等式混合的情形，外点法对初始点也没有要求，可以任意取定义域内任意一点，外点法是真正的将问题转化为无约束问题；
- 内点法初始点必须为可行区内一点，在约束比较复杂时，这个选择内点法的初始点是有难度的，并且内点法只能解决约束为不等式情形。

------

### 等式约束罚函数：

*根据约束条件的特点，构造出惩罚惩罚项，然后加入到目标函数中，将其转化为无约束问题*

对于如下约束问题：

![img](https://pic2.zhimg.com/80/v2-cd74b29bae183f8decb2b7f2a275c355_720w.webp)

构造辅助函数，求辅助函数最小值：

![img](https://pic2.zhimg.com/80/v2-ee95558c10d1158d2ca962ceceed2f05_720w.webp)

σ是惩罚因子，取很大的正数， F(x,σ)是罚函数， σP(x)是惩罚项

惩罚项的需满足条件

- P(x) = 0当且仅当x为问题可行点---**可行域/可行点就是满足g(x)约束条件的点或点集**
- P(x)为连续函数---方便求导求极值
- 对所有x ∈ Rn, P(x) ≥ 0

### **原理：当x在可行**域**内，无惩罚，一般优化方法求最小值；当x不在可行域，加惩罚使F(x,**σ**)远离最优解；即σ→∞，若原问题有解，则必然会在可行域内，且minf(x)==minF(x,**σ**)**

------

## 1. 外点罚函数法

> 外点法是从可行区外慢慢接近边界，在接近的过程中计算每个阶段极值点，一旦到达可行区范围内，该极值点即为原带约束非线性规划的极值点

**1）等式：**

目标函数： min f(x)

约束集合： s.t. hi(x)=0 i=1,2,3,...m

增广为外点罚函数：

![img](https://pic2.zhimg.com/80/v2-07ed61d78315bbfe5d08b87c48cd4fb9_720w.webp)

**2）不等式：**

目标函数： min f(x)

约束集合： s.t. gi(x)>=0 i=1,2,3,...m

增广为外点罚函数：

![img](https://pic3.zhimg.com/80/v2-fc42171cd3fa3e1985187f5ba997a352_720w.webp)



**3)混合**

![img](https://pic1.zhimg.com/80/v2-6eddaffb06ae84e6ec524ad9492cf76c_720w.webp)

![img](https://pic3.zhimg.com/80/v2-4cbf8b86e276ab19d7a9d539239e14f2_720w.webp)

## 2. 内点罚函数

> 内点罚函数法是一类保持严格可行性的方法，它总是从可行点出发，并保持在可行域内部进行搜索。因而这类方法只适用于**只有不等式约束**的非线性最优化问题

内点罚函数法的基本思想为在目标函数上引入一个关于约束的障碍项，当迭代点由可行域的内部接近可行域的边界时, 障碍项将趋于无穷大来迫使迭代点返回可行域的内部, 从而保持迭代点的严格可行性。进而将求解约束问题转为求解一系列容易的子问题，从而获得原问题的最优逼近解。方法也称为内点障碍函数法。

目标函数： min f(x)

约束集合： s.t. gi(x)>=0 i=1,2,3,...m

增广为外点罚函数：

![img](https://pic2.zhimg.com/80/v2-fc970fc7c16f5cc0e177c654d48739f9_720w.webp)

µ 是很小的数。则当 x 趋于边界时，F(x, µ) → +∞，否则，当 µ 很小时，F(x, µ) 的数值近似于 f(x)。

**障碍函数B(x)一般需满足:**

(1) 在可行域内连续

(2) 当x趋于g(x)=0的边界，B(x) → ∞.

### 两种常用的障碍函数形式:

![img](https://pic1.zhimg.com/80/v2-a7aae3f0dca48ed9a092fff95d55f22c_720w.webp)

倒数障碍函数

![img](https://pic2.zhimg.com/80/v2-c559a4188af2651d34eb76c15391eea5_720w.webp)

对数障碍函数

![img](https://pic4.zhimg.com/80/v2-24cf29525bc43beb5c669b3e4807a1ff_720w.webp)

![img](https://pic3.zhimg.com/80/v2-f4357c5d91b5ed079871e0f601c6f31e_720w.webp)



编辑于 2021-12-18 22:41

[惩罚](https://www.zhihu.com/topic/19872067)

[正则化](https://www.zhihu.com/topic/20682937)

[最优化](https://www.zhihu.com/topic/19616819)