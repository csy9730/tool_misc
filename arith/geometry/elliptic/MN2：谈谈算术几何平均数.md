# MN2：谈谈算术几何平均数

[![沈环宇](https://pic1.zhimg.com/b3de08415_xs.jpg?source=172ae18b)](https://www.zhihu.com/people/chen-huan-yu-31)

[沈环宇](https://www.zhihu.com/people/chen-huan-yu-31)

知乎专栏Mathematics Notebook



52 人赞同了该文章

## 高斯的趣闻

可能不少读者听说过卡尔·高斯小学时计算求和 1+2+...+99+100 的趣闻。也许是为了故事的传播效果，小高斯所面对的数学问题被大为简化了，那位名叫比特纳的小学算术老师出的应该是类似下面这种枯燥的等差数列求和：

81297+81495+81693+...+100899

如此一来，比特纳自己能迅速地算出结果，然后看着下面的孩子忙活。当然高斯除外。据说比特纳刚把题目念完，高斯就把他的石板搁在了桌上，并说：“*Ligget se.*” 这是一句农民的土话，意思是“放在那儿了”。然后在剩下的时间里，其他孩子都在辛辛苦苦地算题，高斯却叉着手坐在那里。比特纳不时讽刺地瞥他一眼，心想，班上这个年纪最小的孩子准又是个笨蛋。时间到了，比特纳检查石板，高斯的石板上只有一个数字。高斯直到晚年都很喜欢讲述他写下的那个数字怎样是正确的，其他人的却怎样都是错误的（部分文字摘自《数学大师——从芝诺到庞加莱》）。

不过，我觉得最能体现高斯天才一面的是下面这件事：1791年，14岁的高斯徒手算出了 1 和 2 的**算术几何平均数（AGM，Arithmetic-Geometric Mean）**的前20位小数，所得结果为：

G−1=1.19814023473559220744...

其中 G 是以上结果的倒数，现称为**高斯常数**。它的精确值可以用Γ 函数表示出来：

G=Γ2(14)(2π)3/2

许多常见的广义积分和级数都可以用高斯常数表示，比如下面这三例：

∫01dx1−x4=∫0∞dx1+4x4=π2G

∫0∞J0(x2)dx=π2G

∏n=1∞tanh⁡(πn2)=G

算术几何平均数的建立基于以下观察：任取满足 a0>b0>0 的正数对 (a0,b0) ，注意到二者的算术平均数总是大于几何平均数，且有：

a0>a0+b02>a0b0>b0

将 (a0,b0) 的算术平均数和几何平均数视为一组新的正数对 (a1,b1) ，继续取它们的算术平均数和几何平均数，如此循环下去，就有递推式：

an=an−1+bn−12; bn=an−1bn−1

新正数对的差迅速减小，最后趋于一个介于 a0 和 b0 的共同极限（感兴趣的读者可以尝试证明该极限的存在性）：

a0>a∞=b∞>b0

将其记为 AGM(a0,b0)，这便是正数对 (a0,b0) 的算术几何平均数。

接下来，年轻的高斯转而思考这样一个问题：算术几何平均数是否有解析表达？没人知道高斯在这个问题上花了多少功夫，我们所能看到的是，8年后的1799年12月23日，22岁的高斯最终证明了算术几何平均数列的极限可以被第一类完全椭圆积分 K(k) 所表达。证明的过程并不复杂，我将在下面尝试给出一个。可问题的关键在于，高斯是如何想到要在算术几何平均数与椭圆积分之间建立联系的？不得不说这真是神来之笔，天才的灵感！不过需要指出的是：高斯私底下很早就在研究椭圆积分相关的问题了，并且意识到椭圆积分的反函数——椭圆函数——的研究价值远比椭圆积分本身要大。这可以从下面的不定积分与正弦函数 sin⁡(x) 的类比看出些端倪：

∫dx1−x2=arcsin⁡(x)

被积分母的根式下面是一个二次函数，而椭圆积分是三次或四次的；正弦函数是一类单周期函数，而椭圆函数是复平面上的双周期函数，且周期之比不是一个实数。当然，天才的高斯也很早就看出了这一点。

我下面将给出算术几何平均数的解析表达，同时证明它与第一类完全椭圆积分 K(k) 的关系。不过在此之前先给出两个经典的结论作为引理：



**Lemma1：**第一类完全椭圆积分 K(k) 的两个积分表达式：

K(k)=∫0π2dθ1−k2cos2⁡(θ)=12∫0πdθ1+k2−2kcos⁡(θ)

**Proof：（**略）

**Lemma2：**第一类完全椭圆积分 K(k) 的欧拉变换公式：

K(ix)=11+x2K(x21+x2)

**Proof：**首先，第一类完全椭圆积分 K(k) 可以用超几何函数 2F1 表达出来：

K(k)=π22F1(12,12;1;k2)

利用超几何函数的欧拉转换公式：

2F1(α,β;γ;−x)=(1+x)−α2F1(α,γ−β;γ;x1+x)

就可以得到要证明的结果。Q.E.D.



下面给出算术几何平均数与椭圆积分的关系：

## 定理(Gauss, 1799)：

## AGM(a,b)−1=2π∫0π2dθa2cos2⁡(θ)+b2sin2⁡(θ)=4(a+b)πK(a−ba+b)

**Proof:**

考虑椭圆积分：

M(a,b)=∫0π2dθa2cos2⁡(θ)+b2sin2⁡(θ)

则有：

M(a+b2,ab)=1ab∫0π2dθ1+1ab(a−b2)2cos2⁡(θ)=1abK(ia−b2ab)

利用Lemma2，我们马上就能得到：

M(a+b2,ab)=2a+bK(a−ba+b)

此时将Lemma1中 K(k) 的第二个积分表达式代入，就有：

M(a+b2,ab)=∫0πdθa2(1−cos⁡(θ))+b2(1+cos⁡(θ))=∫0π2dθa2cos2⁡(θ)+b2sin2⁡(θ)

第二步套用了半角公式。所以，我们看到高斯构造的椭圆函数 M(a,b) 在算术几何平均数列的迭代下保持不变。当迭代次数趋于无穷时， a∞=b∞ ，所以有：

M(a,b)=M(a∞,b∞)=M(a∞,a∞)=1a∞∫0π2dθ=π2a∞=π2AGM(a,b)−1

Q.E.D.

与此同时，我们还得到了算术几何平均数的泰勒展开：

**Corollary**：

1AGM(1+x,1−x)=1+∑n=1∞((2n−1)!!)2((2n)!!)2x2n,(|x|<1)

**Proof：**将 K(k) 的超几何级数表示代入即可。



## 高斯—勒让德算法

在数学界，形如算术几何平均数这样的“迭代算法”有个专门的名称，叫高斯——勒让德算法。通过雅可比椭圆函数间的代数关系构造特定的椭圆积分，许多数学常数（比如 π ， Γ(1/4) 等）都可以用高斯——勒让德算法来逼近。因此，算术几何平均数不仅是一个“数学游戏”，它实际上还是一种具有**二阶收敛性** 的椭圆积分数值计算法。所谓二阶收敛性，表示一次迭代就可以将精确位数翻倍。尤其是计算机发明后，这类算法更容易通过代码实现，因此应用广泛。不过，高斯——勒让德算法也有不可回避的缺点，就是迭代次数增多的时候需要的内存也较大。

笔者许多年前曾给出过一个计算高斯常数 G 的二阶收敛算法，现陈述于下，以作本文的结尾，同时也给读者一个二阶收敛算法的直观体验。

定义初值：

A0=C0=1/24,B0=1A1=1/28,B1=12+122,C1=12−122

每次迭代执行如下三步：

Bn+2=Bn+An2,Cn+2=Bn−An2,An+1An=Cn−12Cn

则：

G−1≈2(An)2≈2(Bn)2Cn→0

将上面的公式迭代一次，我们就能得到14岁的高斯所计算的 AGM(2,1) 的前4位和前10位小数逼近；迭代两次就能得到19位小数逼近：

位G−1≈2(B2)2=(1+242)2(4位)

位G−1≈2(B3)2=(27/8+2+2)2232(10位)

位G−1≈2(B4)2=(2+23/4+223/162+24)2252(19位)

etc.

文末彩蛋：上面算法给出的所有逼近都属于2的二次扩张塔 ^_^

发布于 2020-04-20 10:16