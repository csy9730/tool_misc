# 参数估计


# MLE MAP





- 已知概率（概率密度分布曲线pdf），
  - 给定一个样本，计算概率是容易的。
  - 生成一个样本是容易的（但是结果的方差大，不稳定）
- 给定样本，
  - 推出概率（概率密度分布曲线pdf）是困难的。
    - 假设了pdf形式，需要使用参数估计方法。
    - 大数定理可以通过提高采样次数，降低参数估计的方差。



## MLE

**极大似然估计提供了一种给定观察数据来评估模型参数的方法，即：“模型已定，参数未知”。**

**极大似然估计中采样需满足一个重要的假设，就是所有的采样都是独立同分布的。**

- 通过指定隐参数θ（均值，方差），指定分布（高斯分布），可以确定pdf函数。
- 隐参数θ视为未知的常数。
- 通过pdf，给定采样的样本，可以确定概率。
- 通过独立同分布假设，多次采样可以得到联合概率。
- 对联合概率关于隐参数求导，获得最大值点的隐参数。

### MAP

- 隐参数假设为符合一个先验分布：均匀分布，高斯分布（参数为超参数）p(θ)。
- 通过指定隐参数θ（均值，方差），指定分布（高斯分布），可以确定pdf似然函数p(X|θ)。
- 对于采样的样本X1，可以确定条件概率p(X1|θ)。
- 使用贝叶斯公式，计算后验概率p(θ|X1)= p(X1|θ)p(θ)/p(X1)
- 实际计算中，无需计算贝叶斯公式的分母项p(X1)
- 通过独立同分布假设，多次采样可以得到联合后验概率。
- 对联合后验概率关于隐参数求导，获得最大值点的隐参数。



MAP的先验分布使用均匀分布时，结果和MLE相同，即没有正则项。

MAP的先验分布使用高斯分布，相当于MLE添加L2正则化项

MAP的先验分布使用拉普拉斯分布，相当于MLE添加L1正则化项





### 贝叶斯推论

- 隐参数假设为符合一个先验分布：均匀分布，高斯分布（参数为超参数）p(θ)。
- 通过指定隐参数θ（均值，方差），指定分布（高斯分布），可以确定pdf似然函数p(X|θ)。
- 对于采样的样本X1，可以确定条件概率p(X1|θ)。
- 使用贝叶斯公式，计算后验概率p(θ|X1)= p(X1|θ)p(θ)/p(X1)
- 实际计算中，需要展开计算贝叶斯公式的分母项p(X1)
- 通过独立同分布假设，多次采样可以得到联合后验概率。
- 对联合后验概率关于隐参数求导，获得最大值点的隐参数。



贝叶斯推论和MAP相似，两者的区别在于：

- 两者都涉及到联合概率分布。MAP/贝叶斯都关于X折叠
- 贝叶斯估计是返回θ的分布（向量），MAP估计是返回一个最优θ（标量）
- MAP不计算分母项，BE计算分母项，BE的结果是向量，BE的计算量大大超过MAP。
- 贝叶斯估计认为所有可能分布都对参数θ估计有贡献。而最大后验估计则是试图最大化后验概率：



### 最大熵估计

熵最大的分布一般是均匀分布，高斯分布。

## demo

### 两点分布示例

考虑一个简单问题，口袋中100个白球和黑球，已知有放回的取球，已知取了a个白球，b个黑球。

问题：推断口袋中有多少个白球和黑球？



假设，口袋中单次取到白球的概率是p，取到黑球的概率是1-p，则白球的总数是100p。

显然，单次取球是两点分布。

计算似然函数：
$$
f(a,b;p)=p^{a}(1-p)^{b}\\
$$
期望通过调整p，使似然函数最大化
$$
p = arg\ max_pf(p)
$$
计算导数
$$

f^{`}(p)=ap^{a-1}(1-p)^{b}+p^{a}b(1-p)^{b-1}*-1\\
=ap^{a-1}(1-p)^{b}-p^{a}b(1-p)^{b-1}\\
=p^{a-1}(1-p)^{b-1}(a(1-p)-pb)\\
=p^{a-1}(1-p)^{b-1}(a-ap-pb)\\
$$
令导数为0：
$$
a-ap-pb=0\\
p=a/(a+b)
$$
显然，概率是a/(a+b)，这也/符合我们的朴素直觉。

### 高斯分布

测量温度。已知测量了N次温度，温度是[x1,xi,xN]。假设符合高斯分布。
$$
f(x)=\frac{1}{\sqrt{2\pi}\sigma}e(-\frac{(x-\mu)^2}{2\sigma^2})
$$
计算似然函数：
$$
L(\mu,\sigma)=\prod_i^N{f(x_i;\mu,\sigma)}\\
=\frac{1}{\sqrt{2\pi}\sigma}e(-\frac{\sum_i^N{(x-\mu)^2}}{2\sigma^2})
$$


取对数：
$$
lnL(\mu,\sigma)=-\frac{\sum_i^N{(x-\mu)^2}}{2\sigma^2}-\ln{\sqrt{2\pi}\sigma}
$$


3
$$
\frac{\partial lnL}{\partial \mu}=...\\
\frac{\partial lnL}{\partial \sigma}=...\\
$$


sigma 取向0， 此时 高斯分布退化成脉冲函数。
sigma取向无穷，此时 高斯分布退化成均匀分布函数。

### laplace 分布




$$
f(x|\mu,b)=\frac{1}{2b}e^{-\frac{|x-\mu|}{b}}
$$
拉普拉斯分布；![[公式]](https://www.zhihu.com/equation?tex=%5Cmu) 是位置参数， ![[公式]](https://www.zhihu.com/equation?tex=b) 是尺度参数。

拉普拉斯分布的期望为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmu) ，方差为 ![[公式]](https://www.zhihu.com/equation?tex=2b%5E2) ，偏度为0，峰度为3。

拉普拉斯分布的密度函数，可以看作是两个指数分布函数的概率密度“背靠背”拼接在一起。（事实上拉普拉斯分布与指数分布确实有很密切的关系）