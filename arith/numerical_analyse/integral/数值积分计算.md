# 定积分数值计算

## 问题


$$
I=\int_a^b{f(x)dx}
$$


## Newton-Cotes积分法

### Trapezoidal Integral Approximation

梯形公式
$$
I=\frac{b-a}{2}[f(a)+f(b)]
$$

### **中矩形公式**

**中矩形公式**（简称**矩形公式**）
$$
I=(b-a)f(\frac{a+b}{2})
$$


### simpson  2order


$$
I=\frac{b-a}{6}[f(a)+4f(\frac{a+b}{2})+f(b)]
$$

### 3 order

$$
I=\frac{b-a}{8}[f(a)+3f(a+h)+3f(a+2h)+f(b)]\\
h=\frac{b-a}{3}
$$



### 柯特斯公式

布尔法则 4 order牛顿-柯特斯公式（5点积分）


$$
I=\frac{b-a}{90}[7f(a)+32f(a+h)+12f(a+2h)+32f(a+3h)+7f(b)]\\
h=\frac{b-a}{4}
$$


### 牛顿-柯特斯公式

$$
I_n=(b-a)\sum_{k=0}^n{C_k^nf(x+th)}\\
h=\frac{b-a}{n}\\
C_k^n=\frac{(-1)^{n-k}}{nk!(n-k)!}\prod_{j=0,j\neq k}^n{(t-j)dt}
$$



牛顿-柯特斯公式在N》=8时，系数是负的，不具有稳定性。



对于2阶积分与3阶积分具有相同的误差阶；4阶积分与5阶积分具有相同的误差阶。对于阶数更多的积分也一样。因此优先使用偶数阶的积分。



### 复合梯形

区间n等分
$$
I=\frac{h}{2}[f(a)+2\sum_{k=1}^{n-1}{f(x_k)}+f(b)]\\
h=\frac{b-a}{n}\\
x_k=a+kh
$$


### 复合simpson

把区间n等分，
$$
I=\frac{h}{6}[f(a)+4\sum_{k=0}^{n-1}{f(x_{k+1/2})}+2\sum_{k=1}^{n-1}{f(x_k)}+f(b)]\\
h=\frac{b-a}{n}\\
x_k=a+kh
$$


## **龙贝格**算法
Romberg 

### 理查德森(Richardson)外推算法

**理查德森(Richardson)外推算法**。

### 龙贝格-梯形积分

Romberg
$$
T_{2n}=\frac{1}{2}T_n+\frac{h}{2}\sum_{k=0}^{n-1}{f(x_{k+1/2})}\\
T_1=\frac{h}{2}[f(a)+f(b)]
$$


### 龙贝格-simpson积分

### 龙贝格-自适应积分

## Gauss积分法







### Guass-lengendre

高斯-勒让德公式

适用于[-1,1]区间
$$
\int_{-1}^1{f(x)dx}=\sum_{k=0}^n{A_kf(x_k)}
$$




#### n=0

$$
\int_{-1}^1{f(x)dx}\approx2f(0)
$$



#### n=1

$$
\int_{-1}^1{f(x)dx}\approx f(-\frac{1}{\sqrt{3}})+f(\frac{1}{\sqrt{3}})
$$
#### n=2

$$
\int_{-1}^1{f(x)dx}\approx \frac{5}{9}f(-\frac{\sqrt{15}}{5})+\frac{8}{9}f(0)+\frac{5}{9}f(\frac{\sqrt{15}}{5})
$$

#### n=4

$$
x=[-0.9061798,-0.5384693,0,0.5384693,0.9061798]\\
A=[0.2369269,0.4786287,0.5688889,0.4786287,0.2369269]
$$




### 高斯-切比雪夫

高斯-切比雪夫公式

适用于[-1,1]区间

### 高斯-拉盖尔公式

高斯-拉盖尔公式

适用于[0,+inf)区间

###  高斯-埃尔米特

 高斯-埃尔米特公式

适用于(-inf,+inf)区间

### Kronrod积分法

Gauss积分法的缺点是误差估计较难，并且不具有递推性，当节点数增加时，无法直接利用之前计算过的数值。 Kronrod积分法，使得Gauss积分法能够递推，并给出了可靠地误差估计，但牺牲了精度，Kronrod积分法的精度约为3n/2。

**Python语言的SciPy科学计算库就直接支持Gauss-Kronrod积分法**，其底层是Fortran77编写的老牌数学库，速度相当快。默认算法精确到小数点后8位。

## 蒙特卡洛积分

Monte Carlo法是通过大量实验来求取随机变量近似值的一种常用的方法，在现代科学研究中经常用来求解一些建模困难的问题。

## misc

Numerical Methods

