# ODE

### ODE
常微分方程
### 微分方程
$$
\frac{dy}{dx}= f(x,y)
$$
### 积分方程
Integral equation
$$
\int_0^x {f(t, y)dt} +g(x)= y
$$

### 微分方程数值解法

欧拉法，后退欧拉法，梯形法，改进欧拉法

#### 欧拉法
$$
y_{n+1}=y_n + hf(x_n,y_n)\\
$$
只有一阶精度.

#### 后退欧拉法
$$
y_{n+1}=y_n + hf(x_{n+1},y_{n+1})\\

$$
#### 梯形法，
$$
y_{n+1}=y_n + h(f(x_n,y_n)+f(x_{n+1},y_{n+1}))/2\\
$$
#### 改进欧拉法
$$
y_{n+1}=y_n + h(f(x_n,y_n)+f(x_{n+1},y_n+hf(x_n,y_n)))/2\
$$
改进欧拉法是二阶龙格－库塔法。

二阶Runge-Kutta格式具有为2阶精度.
#### 龙格－库塔法

龙格－库塔法（Runge-Kutta methods）是用于非线性常微分方程的解的重要的一类隐式或显式迭代法。这些技术由数学家卡尔·龙格和马丁·威尔海姆·库塔于1900年左右发明。

一般的龙格-库塔法的形式为
$$
K_1=hf(x_i,y_i)\\
K_2=hf(x_i+a_2h,y_i+b_{2,1}K_1)\\
...\\
K_p=hf(x_i+a_ph,y_i+b_{p,1}K_1+...+b_{p,p-1}K_{p-1})\\\\
y_{i+1} = y_i + c_1K_1+c_2K_2+...c_pK_p
$$

龙格-库塔方法的推导基于Taylor展开方法，因而它要求所求的解具有较好的光滑性。如果解的光滑性差，那么，使用四阶龙格-库塔方法求得的数值解，其精度可能反而不如改进的欧拉方法。在实际计算时，应正对问题的具体特点选择适合的算法。对于光滑性不太好的解，最好采用低阶算法而将步长取小
#### R-K3
$$
y_{n+1}=y_n + h/6 (K_1+4K_2+K_3)\\
K_1=f(x_n,y_n)\\
K_2=f(x_n+h/2,y_n+hK_1/2)\\
K_3=f(x_n+h,y_n-hK_1+2hK_2)\\
$$
#### R-K4
在实际中，应用最广泛的是四阶经典的Runge-Kutta格式.
$$
y_{n+1}=y_n + h/6 (K_1+2K_2+2K_3+K_4)\\
K_1=f(x_n,y_n)\\
K_2=f(x_n+h/2,y_n+hK_1/2)\\
K_3=f(x_n+h/2,y_n+hK_2/2)\\
K_4=f(x_n+h,y_n+hK_3)\\

$$


四阶Runge-Kutta方法的优点如下：

- （1）它是一种高精度的单步法，可达四阶精度$O(h^5)$；
- （2）数值稳定性较好；
- （3）只需知道一阶导数，无需明确定义或计算其他高阶导数；
- （4）只需给出$y_n$就能计算出$y_{n+1}$，所以能够自启动；
- （5）编程容易。


#### 隐式的龙格库塔方法

#### 变步长龙格-库塔
变步长的Runge-Kutta方法:作为妥协，如果能在计算过程中实时控制步长的大小，就可以在获得较高的计算速度的同时，保证较高的精度.

Runge-Kutta-Fehlberg
#### ode45
ode45表示采用四阶-五阶Runge-Kutta算法，它用4阶方法提供候选解，5阶方法控制误差，是一种自适应步长（变步长）的常微分方程数值解法，其整体截断误差为$(Δx)^5$。解决的是Nonstiff(非刚性)常微分方程。


