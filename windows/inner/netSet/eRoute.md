# route

route用于维护管理路由表，路由表由路由构成。
每个路由包括：
目标(destination),网络掩码(mask),网关(gateway),接口(interface),跃点数(metric)
route下有常见的增删查改四条子命令：ADD/ DELETE/PRINT/CHANGE。

* 目标指的是当前主机的IP地址
* 子网掩码用于区分当前网段的大小，默认值是255.255.255.255,指的是当前网段有只有一台主机；
    * 子网掩码255.255.255.0，指的是当前网段大概可以容纳254台主机，如果ip是192.168.137.5,则 192.168.137.1~192.168.137.254可用，缩略写法是192.168.137.0/24。
    * 子网掩码255.255.255.240，指的是当前网段大概可以容纳14台主机，如果ip是192.168.137.65,则192.168.137.65~192.168.137.78可用，缩略写法是192.168.137.64/28。
* 路由器本身不产生数据，负责分发交互数据，一个路由器至少有两个ip地址，这样才能在两个网络中充当中间人，交互数据。
* [-p]与Add命令共同使用时，指定路由被添加到注册表并在启动TCP/IP协议的时候初始化IP路由表
* [-f] 清除所有网关项的路由表。这个参数慎用。
* 网关IP和IF参数对应的接口的IP是一样的情况，网关会显示“在链路上”
* 为路由指定所需跃点数的整数值(范围是1～9999)，它用来在路由表里的多个路由中选择与转发包中的目标地址最为匹配的路由。所选的路由具有最少的跃点数。跃点数能够反映跃点的数量、路径的速度、路径可靠性、路径吞吐量以及管理属性。

环回网络路由（目标为 127.0.0.0，网掩码为 255.255.255.0 的路由）
多播路由（目标为 224.0.0.0，网掩码为 240.0.0.0 的路由）

``` bash
D:\programdata\anaconda\miniconda\pkgs>route

操作网络路由表。

ROUTE [-f] [-p] [-4|-6] command [destination]
                  [MASK netmask]  [gateway] [METRIC metric]  [IF interface]

  -f           清除所有网关项的路由表。如果与某个
               命令结合使用，在运行该命令前，
               应清除路由表。

  -p           与 ADD 命令结合使用时，将路由设置为
               在系统引导期间保持不变。默认情况下，重新启动系统时，
               不保存路由。忽略所有其他命令，
               这始终会影响相应的永久路由。

  -4           强制使用 IPv4。

  -6           强制使用 IPv6。

  command      其中之一:
                 PRINT     打印路由
                 ADD       添加路由
                 DELETE    删除路由
                 CHANGE    修改现有路由
  destination  指定主机。
  MASK         指定下一个参数为“netmask”值。
  netmask      指定此路由项的子网掩码值。
               如果未指定，其默认设置为 255.255.255.255。
  gateway      指定网关。
  interface    指定路由的接口号码。
  METRIC       指定跃点数，例如目标的成本。

用于目标的所有符号名都可以在网络数据库
文件 NETWORKS 中进行查找。用于网关的符号名称都可以在主机名称
数据库文件 HOSTS 中进行查找。

如果命令为 PRINT 或 DELETE。目标或网关可以为通配符，
(通配符指定为星号“*”)，否则可能会忽略网关参数。

如果 Dest 包含一个 * 或 ?，则会将其视为 Shell 模式，并且只
打印匹配目标路由。“*”匹配任意字符串，
而“?”匹配任意一个字符。示例: 157.*.1、157.*、127.*、*224*。

只有在 PRINT 命令中才允许模式匹配。
诊断信息注释:
    无效的 MASK 产生错误，即当 (DEST & MASK) != DEST 时。
    示例: > route ADD 157.0.0.0 MASK 155.0.0.0 157.55.80.1 IF 1
             路由添加失败: 指定的掩码参数无效。
             (Destination & Mask) != Destination。

示例:

    > route PRINT
    > route PRINT -4
    > route PRINT -6
    > route PRINT 157*          .... 只打印那些匹配  157* 的项

    > route ADD 157.0.0.0 MASK 255.0.0.0  157.55.80.1 METRIC 3 IF 2
             destination^      ^mask      ^gateway     metric^    ^
                                                         Interface^
      如果未给出 IF，它将尝试查找给定网关的最佳
      接口。
    > route ADD 3ffe::/32 3ffe::1

    > route CHANGE 157.0.0.0 MASK 255.0.0.0 157.55.80.5 METRIC 2 IF 2

      CHANGE 只用于修改网关和/或跃点数。

    > route DELETE 157.0.0.0
    > route DELETE 3ffe::/32
```

``` bash
D:\programdata\anaconda\miniconda\pkgs>route print
===========================================================================
接口列表
  2...04 92 26 4e f5 f9 ......Realtek PCIe GbE Family Controller
  6...00 15 5d 30 01 07 ......Hyper-V Virtual Ethernet Adapter #3
 16...62 ee 5c cc 95 d4 ......Microsoft Wi-Fi Direct Virtual Adapter
 21...60 ee 5c cc 95 d4 ......Microsoft Wi-Fi Direct Virtual Adapter #2
 12...00 50 56 c0 00 01 ......VMware Virtual Ethernet Adapter for VMnet1
 23...00 50 56 c0 00 08 ......VMware Virtual Ethernet Adapter for VMnet8
 20...00 ff 84 90 72 ce ......Sangfor SSL VPN CS Support System VNIC
 80...00 ff 79 e3 f3 d8 ......SVN Adapter V1.0
  4...60 ee 5c cc 95 d4 ......TP-LINK Wireless USB Adapter
  1...........................Software Loopback Interface 1
 13...7c 15 03 a5 29 99 ......Hyper-V Virtual Ethernet Adapter
 47...00 15 5d 0b 7a ce ......Hyper-V Virtual Ethernet Adapter #2
===========================================================================

IPv4 路由表
===========================================================================
活动路由:
网络目标        网络掩码          网关       接口   跃点数
          0.0.0.0          0.0.0.0     192.168.43.1   192.168.43.235     55
        10.0.75.0    255.255.255.0            在链路上         10.0.75.1    271
        10.0.75.1  255.255.255.255            在链路上         10.0.75.1    271
      10.0.75.255  255.255.255.255            在链路上         10.0.75.1    271
    121.33.243.38  255.255.255.255     192.168.43.1   192.168.43.235    257
        127.0.0.0        255.0.0.0            在链路上         127.0.0.1    331
        127.0.0.1  255.255.255.255            在链路上         127.0.0.1    331
  127.255.255.255  255.255.255.255            在链路上         127.0.0.1    331
      172.28.96.0    255.255.240.0            在链路上       172.28.96.1   5256
      172.28.96.1  255.255.255.255            在链路上       172.28.96.1   5256
   172.28.111.255  255.255.255.255            在链路上       172.28.96.1   5256
     192.168.43.0    255.255.255.0            在链路上    192.168.43.235    311
   192.168.43.235  255.255.255.255            在链路上    192.168.43.235    311
   192.168.43.255  255.255.255.255            在链路上    192.168.43.235    311
   192.168.121.64  255.255.255.240            在链路上    192.168.121.65   5256
   192.168.121.65  255.255.255.255            在链路上    192.168.121.65   5256
   192.168.121.79  255.255.255.255            在链路上    192.168.121.65   5256
    192.168.224.0    255.255.255.0            在链路上     192.168.224.1    291
    192.168.224.1  255.255.255.255            在链路上     192.168.224.1    291
  192.168.224.255  255.255.255.255            在链路上     192.168.224.1    291
    192.168.234.0    255.255.255.0            在链路上     192.168.234.1    291
    192.168.234.1  255.255.255.255            在链路上     192.168.234.1    291
  192.168.234.255  255.255.255.255            在链路上     192.168.234.1    291
        224.0.0.0        240.0.0.0            在链路上         127.0.0.1    331
        224.0.0.0        240.0.0.0            在链路上     192.168.234.1    291
        224.0.0.0        240.0.0.0            在链路上     192.168.224.1    291
        224.0.0.0        240.0.0.0            在链路上         10.0.75.1    271
        224.0.0.0        240.0.0.0            在链路上    192.168.43.235    311
        224.0.0.0        240.0.0.0            在链路上       172.28.96.1   5256
        224.0.0.0        240.0.0.0            在链路上    192.168.121.65   5256
  255.255.255.255  255.255.255.255            在链路上         127.0.0.1    331
  255.255.255.255  255.255.255.255            在链路上     192.168.234.1    291
  255.255.255.255  255.255.255.255            在链路上     192.168.224.1    291
  255.255.255.255  255.255.255.255            在链路上         10.0.75.1    271
  255.255.255.255  255.255.255.255            在链路上    192.168.43.235    311
  255.255.255.255  255.255.255.255            在链路上       172.28.96.1   5256
  255.255.255.255  255.255.255.255            在链路上    192.168.121.65   5256
===========================================================================
永久路由:
  无

IPv6 路由表
===========================================================================
活动路由:
 接口 跃点数 网络目标                网关
  4     71 ::/0                     fe80::7c03:5eff:fe74:b25e
  1    331 ::1/128                  在链路上
  4     71 240e:ff:b026:ffca::/64   在链路上
  4    311 240e:ff:b026:ffca:7c12:4fb:e45b:7fab/128
                                    在链路上
  4    311 240e:ff:b026:ffca:c160:58c0:e45b:71af/128
                                    在链路上
 12    291 fe80::/64                在链路上
 23    291 fe80::/64                在链路上
  6    271 fe80::/64                在链路上
  4    311 fe80::/64                在链路上
 47   5256 fe80::/64                在链路上
 13   5256 fe80::/64                在链路上
 12    291 fe80::862:2ce5:582a:a977/128
                                    在链路上
 13   5256 fe80::6957:6bef:c3f8:c28/128
                                    在链路上
 23    291 fe80::a583:4ce1:1cfc:3d3b/128
                                    在链路上
  4    311 fe80::c160:58c0:e45b:71af/128
                                    在链路上
 47   5256 fe80::cd0e:d5cc:d05e:56b3/128
                                    在链路上
  6    271 fe80::f14d:fe5f:5cb8:9520/128
                                    在链路上
  1    331 ff00::/8                 在链路上
 12    291 ff00::/8                 在链路上
 23    291 ff00::/8                 在链路上
  6    271 ff00::/8                 在链路上
  4    311 ff00::/8                 在链路上
 47   5256 ff00::/8                 在链路上
 13   5256 ff00::/8                 在链路上
===========================================================================
永久路由:
  无
