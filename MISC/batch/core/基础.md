# base

## 
### REM 和::
REM 为注释命令，一般用来给程序加上注解，该命令后的内容不被执行，但能
回显。
:: 也可以起注释作用, 而且更简洁有效; 但有两点需要注意：
①任何以冒号:开头的字符行, 在批处理中都被视作标号, 而直接忽略其后的
所有内容。而标号分为有效和无效两种。
有效标号：冒号后紧跟一个以字母数字开头的字符串，goto 语句可以识别。
无效标号：冒号后紧跟一个非字母数字的一个特殊符号，goto 无法识别的标
号。
无效可以起到注释作用，所以:: 常被用作注释符号，其实:+ 也可起注释作用。
②与rem 不同的是, ::后的字符行在执行时不会回显, 无论是否用echo on
打开命令行回显状态, 因为命令解释器不认为他是一个有效的命令行, 就此点来
看, rem 在某些场合下将比:: 更为适用; 另外, rem 可以用于config.sys 文件
中。
行内注释格式：%注释内容% （不常用，容易引起语法错误，慎用少用）

### ECHO 和@
@字符放在命令前将关闭该命令回显，无论此时echo 是否为打开状态。
echo 命令的作用列举如下：
（1）打开回显或关闭回显功能
格式:echo [{ on|off }]
如果想关闭“ECHO OFF”命令行自身的显示，则需要在该命令行前加上“@”。
（2）显示当前ECHO 设置状态
格式:echo
（3）输出提示信息
格式：ECHO 信息内容
上述是ECHO 命令常见的三种用法，也是大家熟悉和会用的，但作为DOS 命
令淘金者你还应该知道下面的技巧：
（4）关闭DOS 命令提示符
在DOS 提示符状态下键入ECHO OFF，能够关闭DOS 提示符的显示使屏幕
只留下光标，直至键入ECHO ON，提示符才会重新出现。
（5）输出空行，即相当于输入一个回车
格式：ECHO．
值得注意的是命令行中的“．”要紧跟在ECHO 后面中间不能有空格，否则“．”
将被当作提示信息输出到屏幕。另外“．”可以用，：；”／[\]＋等任一符号替代。
命令ECHO．输出的回车，经DOS 管道转向可以作为其它命令的输入，比如
echo.|time 即相当于在TIME 命令执行后给出一个回车。所以执行时系统会在显
示当前时间后，自动返回到DOS 提示符状态
（6）答复命令中的提问
格式：ECHO 答复语|命令文件名
上述格式可以用于简化一些需要人机对话的命令（如：CHKDSK／F；FORMAT
Drive:；del *.*）的操作，它是通过DOS 管道命令把ECHO 命令输出的预置答
复语作为人机对话命令的输入。下面的例子就相当于在调用的命令出现人机对话
时输入“Y”回车：
C:>ECHO Y|CHKDSK/F
C:>ECHO Y|DEL A :*.*
（7）建立新文件或增加文件内容
格式：ECHO 文件内容>文件名
ECHO 文件内容>>文件名
例如：
C:>ECHO @ECHO OFF>AUTOEXEC.BAT 建立自动批处理文件
C:>ECHO C:\CPAV\BOOTSAFE>>AUTOEXEC.BAT 向自动批处理文件中追
加内容
（8）向打印机输出打印内容或打印控制码
格式：ECHO 打印机控制码>PRN
ECHO 打印内容>PRN
用得很少，了解就可以了
下面的例子是向M－1724 打印机输入打印控制码。＜Alt＞156 是按住Alt 键在
小键盘键入156，类似情况依此类推：
C:>ECHO +156+42+116>PRN（输入下划线命令FS＊t）
C:>ECHO PRN">+155@>PRN（输入初始化命令ESC@）
C:>ECHO.>PRN（换行）
（9）使喇叭鸣响
C:>ECHO ^G
“^G”是在dos 窗口中用Ctrl＋G 或Alt＋007 输入，输入多个^G 可以产生多声鸣
响。使用方法是直接将其加入批处理文件中或做成批处理文件调用。
这里的“^G”属于特殊符号的使用，请看本文后面的章节

### PAUSE 暂停
PAUSE，玩游戏的人都知道，暂停的意思
在这里就是停止系统命令的执行并显示下面的内容。
例：
PAUSE
运行显示：
请按任意键继续. . .
要显示其他提示语，可以这样用：
Echo 其他提示语& pause > nul

### errorlevel 程序返回码
echo %errorlevel%
每个命令运行结束，可以用这个命令行格式查看返回码
用于判断刚才的命令是否执行成功
默认值为0，一般命令执行出错会设errorlevel 为1
3.1.6. title 设置cmd 窗口的标题
设置cmd 窗口的标题，批处理编程常用。
title 新标题#可以看到cmd 窗口的标题栏变了
3.1.7. COLOR 设置cmd 窗口前景和背景颜色
设置默认的控制台前景和背景颜色。批处理编程常用。
COLOR [attr]
attr 指定控制台输出的颜色属性
颜色属性由两个十六进制数字指定-- 第一个为背景，第二个则为
前景。每个数字可以为以下任何值之一:
0 = 黑色8 = 灰色
1 = 蓝色9 = 淡蓝色
2 = 绿色A = 淡绿色
3 = 湖蓝色B = 淡浅绿色
4 = 红色C = 淡红色
5 = 紫色D = 淡紫色
6 = 黄色E = 淡黄色
7 = 白色F = 亮白色
如果没有给定任何参数，该命令会将颜色还原到CMD.EXE 启动时
的颜色。这个值来自当前控制台窗口、/T 开关或
DefaultColor 注册表值。
如果用相同的前景和背景颜色来执行COLOR 命令，COLOR 命令
会将ERRORLEVEL 设置为1。
例如: "COLOR fc" 在亮白色上产生亮红色
3.1.8. mode 配置系统设备
配置系统设备。
串行口: MODE COMm[:] [BAUD=b] [PARITY=p] [DATA=d] [STOP=s]
[to=on|off] [xon=on|off] [odsr=on|off]
[octs=on|off] [dtr=on|off|hs]
[rts=on|off|hs|tg] [idsr=on|off]
设备状态: MODE [device] [/STATUS]
打印重定向: MODE LPTn[:]=COMm[:]
选定代码页: MODE CON[:] CP SELECT=yyy
代码页状态: MODE CON[:] CP [/STATUS]
显示模式: MODE CON[:] [COLS=c] [LINES=n]
击键率: MODE CON[:] [RATE=r DELAY=d]
例：设置dos 窗口和颜色
mode con cols=113 lines=15 & color 9f
此命令设置DOS 窗口大小：15 行，113 列
3.1.9. GOTO 和:
GOTO 会点编程的朋友就会知道这是跳转的意思。
在批处理中允许以“:XXX”来构建一个标号，然后用GOTO XXX 跳转到标号:XXX
处，然后执行标号后的命令。
例：
if {%1}=={} goto noparms
if "%2"=="" goto noparms
标签的名字可以随便起，但是最好是有意义的字符串啦，前加个冒号用来表
示这个字符串是标签，goto 命令就是根据这个冒号（:）来寻找下一步跳到
到那里。最好有一些说明这样你别人看起来才会理解你的意图啊。
例：
@echo off
:start
set /a var+=1
echo %var%
if %var% leq 3 GOTO start
pause
运行显示：
1
2
3
4
3.1.10. 9、find 在文件中搜索字符串
在文件中搜索字符串。
FIND [/V] [/C] [/N] [/I] [/OFF[LINE]] "string" [[drive:][path]filename[ ...]]
/V 显示所有未包含指定字符串的行。
/C 仅显示包含字符串的行数。
/N 显示行号。
/I 搜索字符串时忽略大小写。
/OFF[LINE] 不要跳过具有脱机属性集的文件。
"string" 指定要搜索的文字串，
[drive:][path]filename
指定要搜索的文件。
如果没有指定路径，FIND 将搜索键入的或者由另一命令产生的文字。
Find 常和type 命令结合使用
Type [drive:][path]filename | find "string" [>tmpfile] #挑选包含string 的
行
Type [drive:][path]filename | find /v "string" #剔除文件中包含string 的
行
Type [drive:][path]filename | find /c #显示文件行数
以上用法将去除find 命令自带的提示语（文件名提示）
例：
@echo off
echo 111 >test.txt
echo 222 >>test.txt
find "111" test.txt
pause
运行显示如下：
---------- TEST.TXT
111
请按任意键继续. . .
例：
@echo off
echo 111 >test.txt
echo 222 >>test.txt
type test.txt|find "111"
pause
运行显示如下：
111
请按任意键继续. . .
3.1.11. start 调用外部程序并任其在新窗口自行运行
批处理中调用外部程序的命令（该外部程序在新窗口中运行，批处理程序继
续往下执行，不理会外部程序的运行状况），如果直接运行外部程序则必须
等外部程序完成后才继续执行剩下的指令
例：start explorer d:\
调用图形界面打开D 盘
3.1.12. 11、assoc 和ftype
文件关联，不常用。
assoc 设置'文件扩展名'关联，关联到'文件类型'
ftype 设置'文件类型'关联，关联到'执行程序和参数'
当你双击一个.txt 文件时，windows 并不是根据.txt 直接判断用notepad.exe
打开
而是先判断.txt 属于txtfile '文件类型'
再调用txtfile 关联的命令行
txtfile=%SystemRoot%\system32\NOTEPAD.EXE %1
可以在"文件夹选项"→"文件类型"里修改这2 种关联
assoc #显示所有'文件扩展名'关联
assoc .txt #显示.txt 代表的'文件类型'，结果显示.txt=txtfile
assoc .doc #显示.doc 代表的'文件类型'，结果显
示.doc=Word.Document.8
assoc .exe #显示.exe 代表的'文件类型'，结果显示.exe=exefile
ftype #显示所有'文件类型'关联
ftype exefile #显示exefile 类型关联的命令行，结果显示exefile="%1" %*
assoc .txt=Word.Document.8
设置.txt 为word 类型的文档，可以看到.txt 文件的图标都变了
assoc .txt=txtfile
恢复.txt 的正确关联
ftype exefile="%1" %*
恢复exefile 的正确关联
如果该关联已经被破坏，可以运行command.com ，再输入这条命令
12、pushd 和popd
PUSHD [path | ..] 保存当前目录，然后切换到另一个指定的目录path。
popd 将当前目录恢复为pushd 命令保存的目录
@echo off
c: & cd\ & md mp3 #在C:\ 建立mp3 文件夹
md d:\mp4 #在D:\ 建立mp4 文件夹
cd /d d:\mp4 #更改当前目录为d:\mp4，cd 命令的/d 参数可改变盘符。
pushd c:\mp3 #保存当前目录，并切换当前目录为c:\mp3
popd #恢复当前目录为刚才保存的d:\mp4
一般用处不大，在当前目录名不确定时，会有点帮助。（dos 编程中很有用）