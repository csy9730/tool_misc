# 彻底解决Windows XP网络文件共享

出处：本站会员oocnwoo收集 作者：请作者联系 时间：2005-1-12 16:47:00
[邮件中继服务 七天免费试用](http://www.5dmail.com.cn/services/relay.html)



导致Windows XP网络邻居不能正确浏览或浏览列表不全的因素很多，解决问题需要对症下药，而诊断过程分两个步骤：测试基本连接、解决文件共享问题。

一、解决基本连接问题。

1、检查计算机之间的物理连接。

　　网卡是网络连接的基本设备，在桌面计算机中，每个网卡后面的指示灯应该是亮的，这表示连接是正常的。如果不亮，请检查集线器或交换机是打开的，而且每个客户端连接的指示灯都是亮的，这表示链接是正常的。接下来检查网线的水晶头是否接触良好。

2、确保所有计算机上都安装了TCP/IP，并且工作正常。

　　在Windows XP中默认安装了TCP/IP。但是，如果出了网络问题想卸载后重新安装TCP/IP就不容易了：在“本地连接”属性中显示的此连接使用下列项目列表中单击Internet协议(TCP/IP)项，您将发现卸载按钮不可用(被禁用)。

这是因为传输控制协议/Internet协议(TCP/IP)堆栈是Microsoft XP/ 2003的核心组件，不能删除。在这种情况下，如果需要重新安装TCP/IP以使TCP/IP堆栈恢复为原始状态。可以使用NetShell实用程序重置TCP/IP堆栈，使其恢复到初次安装操作系统时的状态。方法是：在命令提示符后键入以下命令，然后按ENTER键：netsh int ip reset c:\resetlog.txt，其中，Resetlog.txt记录命令结果的日志文件，一定要指定，这里指定了Resetlog.txt日志文件及完整路径。运行此命令的结果与删除并重新安装TCP/IP协议的效果相同。

　　另外，不会还有人用95吧，WIN95默认情况下不自动安装TCP/IP协议。

　3、检查IP地址

　　有几种情况：

　　查看不同的计算机的IP是否在同一范围内，方法是在MSDOS方式下输入IPCONFIG/ALL。如果一台计算机收到的地址在192.168.0.x范围内，而另一台收到的地址在169.254.x.y范围内，需要根据网络拓扑确定哪一个是正确的地址。然后，集中解决地址错误的那台计算机的问题。

　　关于169.254.x.y类IP地址

　　在不存在Internet连接的情况中，或者，每台计算机都有一个单独的Internet连接(拨号连接或宽带连接)。在这种配置中，计算机通常给自己分配169.254.x.y范围内的IP地址(其中x和y是1到254之间的数字)。而将ISP提供的地址用于Internet连接。

　　关于192.168.0.X类IP地址

　　一台计算机通过使用Internet连接共享连接到共享的Internet。该连接可以是拨号连接或宽带连接(一般是xDSL或电缆调制解调器)。该计算机也被称为代理服务器，常见的代理有SYGATE、WINGATE、NAT、ISA、CCPROXY等。通常是由代理服务器负责为家庭网络中的其他计算机分配IP地址。共享连接的计算机应该为连接到家庭网络的网卡配置IP地址192.168.0.1。网络上其他计算机的地址应在192.168.0.x范围内(其中x是2到254之间的数字)。当然，可以在成功共享后修改IP地址，如10.X.Y.Z等。

　　计算机连接到集线器，并且集线器通过宽带连接与Internet连接。这种配置也称为无边界网络。在这种配置中，家庭网络中的每台计算机都有一个Internet服务提供商(ISP)提供的IP地址。使用的地址因ISP而异。无边界网络是一种特殊情况。在这种情况下应使用ICF，但必须采取其他措施才能在家庭网络启用连接。

4、使用ping命令测试网络中两台计算机之间的连接：

　　ping其它计算机IP，在命令提示处，键入ping x.x.x.x(其中x.x.x.x是另一台计算机的IP地址)，然后按ENTER键。应该可以看到来自另一台计算机的几个答复，如：

　　Reply from x.x.x.x:bytes=32 time<1ms TTL=128

　　如果没有看到这些答复，或者看到"Request timed out"，说明本地计算机可能有问题。如果ping命令成功执行，那么您就确定了计算机可以正确连接，可以跳过下一步。如果没有看到这些答复，或者看到"Request timed out"，说明本地计算机可能有问题。PING本地IP，如果看到"Request timed out"，说明本地计算机可能有问题。

5、使用ping命令测试网络中名称解析是否正常

　　ping computername，其中computername是远程计算机的名称。通过ping命令用名称测试计算机连接。确定计算机的名称的方法是：在命令提示处，输入SYSTEMINFO。或者在桌面上右击我的电脑-属性，然后单击计算机名称选项卡。如果看到该命令的成功答复，说明您在计算机之间具有基本连接和名称解析。名称解析跟NETBIOS密切相关，看下面的步骤。

6、分析日志

　　检查"网络安装向导"日志文件中没有成功执行的任何步骤中的错误。打开该日志的方法是依次单击开始、运行，键入%SystemRoot%\nsw.log，然后按ENTER键。如果Nsw.log文件没有提供有关该问题的信息，请检查系统日志中的错误并查明错误原因。

二、解决文件和打印机共享问题

　1、正确安装网络组件

　　首先右击网上邻居-属性，选择要共享的网卡。把IP设置在局域网的同一个网段上。比如192.168.0.X网段。然后看一下TCP/IP的高级属性中，是否开启NETBIOS。在利用WINNT4.0构建的网络系统中，对每一台主机的唯一标识信息是它的NetBIOS名，系统是利用WINS服务、信息广播方式及Lmhost文件等多种模式将NetBIOS名解析为相应IP地址，从而实现信息通讯。在内部网络系统中(也就是通常我们所说的局域网中)，利用NetBIOS名实现信息通讯是非常方便、快捷的。但是在Internet上对一台主机的唯一标识信息是它的FQDN格式的域名(如www.163.com)，在Internet是利用DNS标准来实现将域名解析为相应IP地址，WIN2K支持动态DNS，运行活动目录服务的机器可动态地更新DNS表。WIN2K网络中可以不再需要WINS服务，但是WIN2K仍然支持WINS，这是由于向后兼容的原因。目前，大多数网络是混合网，既有Win98等系统，又有WINXP/WIN2K等系统，因此需要在TCP/IP协议上捆绑NETBIOS解析计算机名。

查看是否选定“文件和打印服务”组件，如果已将其取消选中，“浏览服务”将不绑定到NetBIOS接口。成为备份浏览器并且没有启用“文件和打印共享”的基于Windows的计算机无法将浏览列表与客户机共享。任何将要包括在浏览列表中的计算机也都必须启用“文件和打印共享”。

2、启动"计算机浏览器"服务

　　计算机浏览器"服务在网络上维护一个计算机更新列表，并将此列表提供给指定为浏览器的计算机。如果停止了此服务，则既不更新也不维护该列表。

　　启动"计算机浏览器"服务

　　单击开始，右击我的电脑，然后单击管理。

　　在控制台树中，展开"服务和应用程序"。

　　单击服务。

　　在右边的详细信息窗格中，检查"计算机浏览器"服务是否已启动，右击计算机浏览器，然后单击启动。

　　关闭"计算机管理"窗口。

3、查看共享文件夹

　　请依次单击开始、运行，键入fsmgmt.msc，然后单击确定。在左窗格中，单击共享。右窗格中随即出现共享文件夹列表。记下每台计算机的相应共享名称。

上面的大家肯定都没问题。多数人没有互访问成功都是因为下面的原因：

4、起用Guest(来宾)帐户

　Windows XP的Guest帐户允许其他人使用你的电脑，但不允许他们访问特定的文件，也不允许他们安装软件。对Windows XP Home Edition计算机或工作组中的Windows XP Professional计算机的所有网络访问都使用来宾帐户。使用net user guest确保为网络访问设置了来宾帐户，如果该帐户是活动的，命令输出中会出现一行类似下面这样的内容：Account active Yes；如果该帐户不是活动的，请使用下面的命令授予来宾帐户网络访问：

　　net user guest /active:yes

5、允许Guest(来宾)帐号从网络上访问。这一步很重要!

在运行里输入gpedit.msc，弹出组策略管理器，在‘计算机配置-Windows设置-本地策略-用户权利指派’中，有“拒绝从网络访问这台计算机”策略阻止从网络访问这台计算机，其中居然有GUEST帐号，谁能访问这台计算机。解决办法是删除拒绝访问中的GUEST帐号。

6、设置防火墙允许浏览服务

　　网络安全重要，所以最好开启网络防火墙，但是防火墙阻断正常的网络浏览服务通讯，结果是别人在网上邻居中看不到你的计算机，有没有两全其美的办法在开启防火墙的前提下允许浏览服务。办法是，如果开启了ICF，打开属性，在服务这栏，选择添加，添加服务的对话框共有四个编辑框，最上边是描述服务名称，以便于记忆，从上到下第二个是应用服务的IP地址或名称，输入127.0.0.1表示本机。下面连个是内外端口号，旁边的tcp/udp标示这个端口是udp连接还是tcp连接。

按照下面的表格输入3个服务

　　名称　　　　　　　　　　　协议　　　　　　　端口

　　NetBIOS Name Service　　　　UDP　　　　　　　　137

　　NetBIOS Datagram Service UDP　　　　　　　　138

　　NetBIOS Session Service　　TCP　　　　　　　　139

　　137/UDP -- NetBIOS名称服务器,网络基本输入/输出系统(NetBIOS)名称服务器(NBNS)协议是TCP/IP上的NetBIOS (NetBT)协议族的一部分，它在基于NetBIOS名称访问的网络上提供主机名和地址映射方法。

　　138/UDP -- NetBIOS数据报,NetBIOS数据报是TCP/IP上的NetBIOS (NetBT)协议族的一部分，它用于网络登录和浏览。

　　139/TCP -- NetBIOS会话服务,NetBIOS会话服务是TCP/IP上的NetBIOS (NetBT)协议族的一部分，它用于服务器消息块(SMB)、文件共享和打印。

　　Windows XP最新的SP2补丁对ICF做了很大的改进，功能更强大了，ICF有了自己的设置项，安装SP2后，默认情况下，启用ICF防火墙，不允许任何外部主动连接，即使是本地的应用程序要访问网络也需要在许可列表中做设置。

7、取消简单文件共享

　　Windows 2000操作系统中用户在设置文件夹的共享属性时操作非常简便，只需用鼠标右击该文件夹并选择属性，就可以看到共享设置标签。而在Windows XP系统设置文件夹共享时则比较复杂，用户无法通过上述操作看到共享设置标签。具体的修改方法如下：打开"我的电脑"中的"工具"，选择"文件夹属性"，调出"查看"标签，在"高级设置"部分滚动至最底部将"Use simple file sharing (Recommended)"前面的选择取消，另外如果选项栏里还有"Mickey Mouse"项也将其选择取消。这样修改后用户就可以象使用Windows 2000一样对文件夹属性进行方便修改了。

8、多种方法访问“网络计算机”

　　例如要打开网络中名为“IBMZB”的计算机，其IP地址为10.41.221.5，如果你不清楚其它机器的IP地址，你可以使用“PING计算机名”来获得它的IP地址。

　　用计算机名访问，NETBIOS提供的服务。点击“开始”菜单，单击“运行”，在运行栏输入“\IBM-ZB”，单击“确定”。

　　用IP地址访问，在运行输入栏中输入“\10.41.221.5”，单击“确定”。

　　用搜索计算机的方法访问，计算机更新列表需要时间，搜索计算机可以加快更新列表。点击“网上邻居”右键中的“搜索计算机”，输入计算机名，点击“立即搜索”，就可以看到你要访问的计算机。直接双击右边计算机名就可以打开它了。

　　用映射驱动器的方法访问，进入MS-DOS方式，输入“NET VIEW \IBMZB”，回车这是查看计算机IBMZB上有哪些共享文件夹，如D。再输入NET USE Z:\IBMZB\D将计算机IBM-ZB共享的文件夹D映射为H：盘，在命令提示符下键入“Z:”。你会发现你已经连到IBMZB计算机上了。

　9、检查RPC、Plug and Play服务已启动，检查相应的系统文件夹的权限，重新注册以下的动态链接库：

　　regsvr32 netshell.dll

　　regsvr32 netcfgx.dll

　　regsvr32 netman.dll,