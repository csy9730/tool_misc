# Cookie如何暴露你在互联网上的行踪

李松峰

2013-03-18

推荐

21

![收藏](https://www.ituring.com.cn/img/fav-icon.967a3440.svg)

收藏

> 大前天，央视315晚会曝光“Cookie跟踪泄漏隐私”，引发网友普遍关注。最引发共鸣的好像是这个扫盲帖：http://t.cn/zYd0A5y，称央视这种“揭批”是“矫情”。恰好昨天翻译*D is for Digital*（http://t.cn/zOi1i8m）第11章，其中也谈到了隐私与跟踪，而且用实例解释了Cookie跟踪的原理，推荐大家一读。

只要上网，我们的信息就会被收集，而如果没有我们留下的蛛丝马迹，几乎什么事儿也干不了。使用其他系统时的情况也一样，特别是使用手机的时候，手机网络随时都知道我们在哪里。如果是在户外，支持GPS的手机（现在的智能手机几乎都支持）定位用户的误差不超过10米，而且随时都会报告你的位置。（我的手机报告我的位置时误差也只有20米，而我是在自己的办公室里，办公室所在的大楼属于中等规模建筑。）有些数码相机也带GPS，可以在照片中编入地理位置信息，这种做法被称为**打地理标签**。

把多个来源的跟踪信息汇总起来，就可以绘制一幅关于个人的活动、喜好、财务状况，以及其他很多方面的信息图。这些信息最起码可以让广告客户更精准地定位我们，让我们看到乐意点击的广告。不过，跟踪数据的应用可远不止于此。这些数据还可能被用在很多我们意想不到的地方。比如根据收入把人分成三六九等，在贷款时区别对待，或者更糟糕地，被人冒名顶替，被政府监控，被人图财，甚至害命。

怎么收集我们的浏览信息呢？有些信息会随着浏览器的每一次请求发送，包括你的IP地址、正在浏览的页面（referrer，即来源页）、浏览器的类型和版本、操作系统，还有语言偏好。

此外，如果服务器的域中有cookie，那么这些“小甜饼”也会随浏览器请求一块发送。根据cookie的规范，只能把这些保存用户信息的小文件发给最初生成它们的域。那还怎么利用cookie跟踪我对其他网站的访问呢？

要知道答案，就得明白链接的工作原理。每个网页都包含指向其他页面的链接（这正是“超链接”的本义）。我们都知道链接必须由我们主动点击，然后浏览器才会打开或转向新页面。但图片不需要任何人点击，它会随着页面加载而自动下载。网页中引用的图片可以来自任何域。于是，在浏览器取得图片时，提供该图片的域就知道我访问过哪个页面了。而且这个域也可以在我的计算机上存放cookie，并且收到之前访问过的域所产生的cookie。

以上就是实现跟踪的秘密所在，下面我们再通过例子来解释一下。假设我想买一辆新车，因此访问了toyota.com。我的浏览器因此会下载60 KB的HTML文件，还有一些JavaScript，以及40张图片。其中一张图片的源代码如下：

```
<img src="http://ad.doubleclick.net/ad/
                  N2724.deduped_spotlight/B1009212;
                  sz=1x1;tag=total_traffic;ord=1?"
                  width=1 height=1 border=0>
```

这个``标签会让浏览器从ad.doubleclick.net下载一张图片。这张图片只有1像素宽、1像素高，没有边框，而且很可能是透明的，总之页面上看不见它。当然，这张图片根本就没想让人看到。当我的浏览器请求它时，DoubleClick会知道我正在浏览丰田汽车公司网站的某个页面，而且（如果我允许）还会在我的计算机中保存一个cookie文件。要是我随后又访问了一个内置DoubleClick图片的网站，DoubleClick就可以绘制一张我的“足迹图”。如果我的“足迹”大都留在汽车网站上，DoubleClick会把这个信息透露给自己的广告客户。于是乎，我就能看到汽车经销商、购车贷款、修车服务、汽车配件等等各种广告。如果我的“足迹”更多与交通事故或止疼有关，那么就会看到律师和医生投放的广告。

DoubleClick（现为谷歌所有）在拿到用户访问过的站点信息后，会根据这些信息向丰田等广告客户推销广告位。丰田公司继而利用这些信息定向投放广告，而且（可能）会参考包括我的IP地址在内的其他信息。（DoubleClick不会把这些信息卖给任何人。）随着我访问的页面越来越多，DoubleClick就可以绘制一幅关于我的更详细的图画，借以推断我的个性、爱好，甚至知道我已经60多岁了，是个男的，收入中上，住在新泽西中部，在普林斯顿大学上班。知道我的信息越多，DoubleClick的广告客户投放的广告就越精准。到了某个时刻，DoubleClick甚至可以确定那个人就是我，尽管大多数公司都声称不会针对具体的某个人。可是假如我的确在某些网页中填过自己的名字和电子邮件地址，那谁也不敢保证这些信息不会被传播。

这套互联网广告系统设计得极其精密。打开一个网页，这个网页的发布者会立即通知雅虎的Right Media或谷歌的Ad Exchange，说这个网页上有一个空地儿正虚位以待，可以显示广告。同时发过去的还有浏览者的信息（例如，25到40岁之间、单身、住在旧金山，是个技术宅，喜欢泡馆子）。于是，广告客户会为这个广告位而竞价，胜出者的广告将被插入到这个网页中。整个过程不过零点几秒而已。