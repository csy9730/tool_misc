
### Lucene
564 人赞同了该回答

Lucene部分源码阅读已经发布:

satanson：Lucene的部分源码阅读​zhuanlan.zhihu.com￼

Lucene还是很复杂的，如果大家有感兴趣的话，可以一起完善. 原文的markdown地址在文章中有连接.

leveldb: 比较优美，简单，不炫技，好看，中规中矩，命名很规范. 一见钟情的感觉. 存储入门看leveldb的源码不错，这个东西可以学到redo log即wal的关键细节：prepare point，commit point，apply point，checkpoint，和prune point. 还有group commit. 压缩编码稍微丰富. fdcache和blockcache也有，读存储格式的iterator的模式. 这些东西，不管是知识还是设计都是可以迁移复用的. 存储入门两个东西wal和rsm，wal这一关先过了. 而且leveldb的函数1000左右，阅读起来也比较舒服. 我甚至在用leveldb当量作为衡量源码的单位.

17年初的时候，写过一个leveldb的英文版本源码解析，回头整理一下，发出来.

clickhouse：模板很骚，读起来比较舒服. 像活泼灵动的少女.

零零散散地看，立个flag, ck今年年底之前搞完源码分析.

lucene：爱好编码的人，可以看看，编码很丰富，很老练，做面试题不错. 像历经沧桑的成熟又保持初心的美人.

lucene除了posting list和term编码编码之外， 已经有一个英文版本的源码草稿，也回头整理一下发出来.

读源码是一件开心的事情.


lucene不是Java写的吗？还是说有部分是c++实现？




### 搜索场景

17 人赞同了该回答

qps算错了，每日搜索量1亿的话，平均qps是1.1k，之前算错成了1.1w

------------------------分割线--------------------------------

刚做了一年多搜索，勉强答一波。。

首先，从编程语言来说，首选C++，次选Java，因为搜索场景要的就是速度，一个通用的搜索引擎，假设访问量是1亿，qps为1.1k，一般能部署30个进程来处理已经不错了，那每个进程每秒也要处理将近40个，也就是说如果不堵塞服务，平均每个进程的处理时间要控制在30ms以内，另外访问高峰期的qps可能会是均值的两倍，所以编程语言就很重要，如果真的达到这个量级，Java可能也扛不住了，最好用C++，我上家公司因为是垂搜，所以访问量其实不大，用Java也还可以；现在是通用搜索，访问量大，所以用的是C++。从编程语言来说，这两种语言至少会一种，另外模型方面和数据处理方面更多是用Python，所以最好也会，如果学会了C++/Java，再学Python其实也很简单了

其次，说一下具体流程，从用户输入到最后返回结果整个链条其实有点长，大致可以分为：Query suggestion，Query理解，文档召回，个性化排序，相关搜索词推荐等，我主要做的是Query理解，所以只从这个角度来分析，需要哪些知识

Query理解又可以分为以下几个步骤：

预处理，无效字符表情什么的直接丢掉了，截取前n个字等

纠错，包括错误检测和自动纠错，目前的方法有：噪声信道模型、序列标注模型、seq2seq模型

分词&词性标注，这个一般都是现成的分词工具+用户词典来做了

词权重计算，计算每个词的重要性，一般会根据用户的点击日志离线算好

同义词

意图分析，为了意图可以扩充，所以一般做成很多个二分类任务，方法比较多，最常见的还是CNN，也有BERT蒸馏到CNN的

实体识别，识别搜索词中的实体词，一般也是序列标注模型BILSTM+CRF，或者BERT蒸馏到BILSTM

丢词，因为目前的搜索引擎更多的是还是以文本匹配的方式进行文档召回，所以如果query中有一些语义不重要的词，那就会丢弃了，并且往往会有多次丢词，比如：北京著名的温泉，在进行召回的时候，会先丢弃“的”字，以“北京、著名、温泉”三个词去和文档集求交集，如果没有好的结果，这三个词会继续丢词，以“北京、温泉”和文档集求交集，这里一般也是用序列标注来做

Query改写，其实丢词&纠错也都算改写的一种，不过这里的改写是指找到原始Query的一些等价或者近似Query，规则的方法比较多，也有用seq2seq的

总结一下，如果只做Query理解相关工作，需要以下能力：

语言：C++/Java, Python

模型：cnn, lstm, crf, seq2seq, bert等

隐藏要求：逻辑能力强

最后再贴一下某家公司的招聘要求，可以做个参考

￼

### 实现简单的搜索引擎
[Python 实现简单的搜索引擎](https://zhuanlan.zhihu.com/p/153442306)

求问你们c++的搜索引擎工具（对标java的es,lucene）是自己写的么还是用开源的
