# 项目设计

[TOC]



## 架构

横向划分和纵向划分，横向划分区分层次，纵向划分分割功能。

横向划分： app层，framework层，library层。数据文件层。
纵向划分： 消息队列，事件系统，



**Q**:设计多少层？是否该扁平化结构还是层级化结构？
**A**:看愿意为以后拓展留下多少拓展空间。任何问题都可以通过增加层数解决。



### 架构模式

#### 分层模式

分层模式正是一个著名的架构模式。
分层模式的规定非常简单而有效：
每个模块都必须属于某个层次，提供给“第N 1层”（上层）服务；同时委派任务给“第N-1层”的模块。
任何一个模块，都不得逆层次调用：属于第N层的模块，不得调用（耦合）第N 1层或以上层次的模块。
任何一个模块，都不得跨层调用：属于第N层的模块，不应该调用第N-2层或更下层的模块。  

典型的分层架构
* 互联网4层模型
    * HTTP/FTP/SMTP/...
    * TCP/UDP
    * IP
    * MAC/物理层
* windows操作系统
    * app
    * kernel
* 服务器架构
    * 客户端
    * 后端
    * 数据库


同态：纵向分层中，实体概念会贯穿各个分层，各个分层都会保留实体的概念，保留不同抽象形式的实体。
设计模式中，所有的接口问题都可以通过增加一个抽象层解决，但是代价也是增加了一个抽象层，增加了一层函数调用，造成了运行时更慢。

####  微内核模式



微内核(Micro Kernel)架构模式一般由下面几个部分组成：

* 内核（通用功能抽象）
* 微内核
* 扩展服务(扩展插件)
* 应用程序与适配器


内核由几个最基本服务组成，内核基本服务通常是指那些与业务无关的通用的功能服务，如资源加载服务，网络功能、日志等等。(可以视为插件容器自带的几个默认插件)

微内核完成加载内核里所有的基本服务。 用来沟通各个不同的模块。

扩展服务，广义来讲可以成为插件，责整合某个特定领域的抽象，通过微内核通信，通过微内核收纳管理。

应用程序通过微内核通信。应用程序通过一个适配器来和微核耦合。这个适配器实际上能让应用程序模块更换不同的微核，这在于可移植系统上很重要。



微核模式实际上是一种特化的分层模式，他把最底层的功能封装成“微核”，同时把各个模块的交互规定为“运行时的事件”。这样简化了的3层架构，提供能非常好的模块独立性。  



## 框架



流程图

## 数据库设计



## 协议设计



## API设计





